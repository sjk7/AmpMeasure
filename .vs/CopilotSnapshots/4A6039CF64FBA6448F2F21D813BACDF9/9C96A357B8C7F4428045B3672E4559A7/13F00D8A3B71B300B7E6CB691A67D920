using System;
using System.Drawing;
using System.Windows.Forms;

namespace AmpMeasure
{
    public partial class AmpMeasureMain : Form
    {
        private void SetAppIcon()
        {
            try
            {
                using (Bitmap bmp = ColumnIconHelper.CreateAppIconImage())
                {
                    IntPtr hIcon = bmp.GetHicon();
                    using (Icon icon = Icon.FromHandle(hIcon))
                    {
                        this.Icon = (Icon)icon.Clone();
                    }
                    DestroyIcon(hIcon);
                }
            }
            catch (Exception ex)
            {
                System.Diagnostics.Debug.WriteLine($"Failed to set app icon: {ex.Message}");
            }
        }

        private void SetupMenuIcons()
        {
            openToolStripMenuItem.Image = ColumnIconHelper.CreateOpenIcon();
            saveToolStripMenuItem.Image = ColumnIconHelper.CreateSaveIcon();
            saveAsToolStripMenuItem.Image = ColumnIconHelper.CreateSaveAsIcon();
            recentFilesToolStripMenuItem.Image = ColumnIconHelper.CreateRecentFilesIcon();
            viewToolStripMenuItem.Image = ColumnIconHelper.CreateViewIcon();
            resetColumnWidthsToolStripMenuItem.Image = ColumnIconHelper.CreateResetWidthsIcon();
            resetColumnOrderToolStripMenuItem.Image = ColumnIconHelper.CreateResetOrderIcon();
            clearGridToolStripMenuItem.Image = ColumnIconHelper.CreateClearGridIcon();
        }

        private void SetDefaultFormSize()
        {
            int totalWidth = 0;
            foreach (DataGridViewColumn column in dataGridView1.Columns)
            {
                totalWidth += 100;
            }
            totalWidth += SystemInformation.VerticalScrollBarWidth + 20;
            this.ClientSize = new Size(totalWidth, 450);
        }
    }
}
