using System;
using System.Drawing;
using System.Drawing.Drawing2D;

namespace AmpMeasure
{
    public static class ColumnIconHelper
    {
        public static Bitmap CreatePeakVoltsIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                // Lightning bolt with gradient
                Point[] points = new Point[]
                {
                    new Point(10, 2),
                    new Point(6, 8),
                    new Point(9, 8),
                    new Point(5, 14),
                    new Point(9, 7),
                    new Point(6, 7),
                    new Point(10, 2)
                };
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(255, 200, 0),
                    Color.FromArgb(255, 140, 0),
                    LinearGradientMode.Vertical))
                {
                    g.FillPolygon(brush, points);
                }
                using (Pen pen = new Pen(Color.FromArgb(200, 100, 0), 1))
                {
                    g.DrawPolygon(pen, points);
                }
            }
            return bmp;
        }

        public static Bitmap CreateRMSVoltsIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                // Sine wave with gradient
                using (Pen pen = new Pen(Color.FromArgb(0, 120, 215), 2.5f))
                {
                    pen.StartCap = LineCap.Round;
                    pen.EndCap = LineCap.Round;
                    for (int x = 0; x < 15; x++)
                    {
                        float y1 = 8 + (float)(4 * Math.Sin(x * Math.PI / 4));
                        float y2 = 8 + (float)(4 * Math.Sin((x + 1) * Math.PI / 4));
                        g.DrawLine(pen, x, y1, x + 1, y2);
                    }
                }
            }
            return bmp;
        }

        public static Bitmap CreateCurrentIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient circle background
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(2, 2, 12, 12),
                    Color.FromArgb(255, 70, 70),
                    Color.FromArgb(200, 30, 30),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 2, 2, 12, 12);
                }
                
                // Outer ring with gradient
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(1, 1, 14, 14),
                    Color.FromArgb(255, 100, 100),
                    Color.FromArgb(220, 50, 50),
                    LinearGradientMode.Vertical))
                {
                    using (Pen pen = new Pen(brush, 1.5f))
                    {
                        g.DrawEllipse(pen, 2, 2, 12, 12);
                    }
                }
                
                // "I" symbol with white/bright color
                using (Font font = new Font("Arial", 9, FontStyle.Bold))
                using (SolidBrush textBrush = new SolidBrush(Color.White))
                {
                    StringFormat sf = new StringFormat();
                    sf.Alignment = StringAlignment.Center;
                    sf.LineAlignment = StringAlignment.Center;
                    g.DrawString("I", font, textBrush, new RectangleF(0, 0, 16, 16), sf);
                }
            }
            return bmp;
        }

        public static Bitmap CreateVoltageIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient circle background
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(2, 2, 12, 12),
                    Color.FromArgb(50, 200, 120),
                    Color.FromArgb(20, 150, 80),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 2, 2, 12, 12);
                }
                
                // Outer ring with gradient
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(1, 1, 14, 14),
                    Color.FromArgb(80, 220, 140),
                    Color.FromArgb(30, 180, 100),
                    LinearGradientMode.Vertical))
                {
                    using (Pen pen = new Pen(brush, 1.5f))
                    {
                        g.DrawEllipse(pen, 2, 2, 12, 12);
                    }
                }
                
                // "V" symbol with white/bright color
                using (Font font = new Font("Arial", 8, FontStyle.Bold))
                using (SolidBrush textBrush = new SolidBrush(Color.White))
                {
                    StringFormat sf = new StringFormat();
                    sf.Alignment = StringAlignment.Center;
                    sf.LineAlignment = StringAlignment.Center;
                    g.DrawString("V", font, textBrush, new RectangleF(0, 0, 16, 16), sf);
                }
            }
            return bmp;
        }

        public static Bitmap CreatePowerInIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient circle background (Purple)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(2, 2, 12, 12),
                    Color.FromArgb(180, 80, 220),
                    Color.FromArgb(100, 40, 150),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 2, 2, 12, 12);
                }

                // Outer ring
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(1, 1, 14, 14),
                    Color.FromArgb(200, 100, 240),
                    Color.FromArgb(120, 50, 160),
                    LinearGradientMode.Vertical))
                {
                    using (Pen pen = new Pen(brush, 1.5f))
                    {
                        g.DrawEllipse(pen, 2, 2, 12, 12);
                    }
                }

                // White Lightning Bolt (Input Energy)
                Point[] bolt = new Point[]
                {
                    new Point(9, 4),
                    new Point(6, 8),
                    new Point(8, 8),
                    new Point(6, 12),
                    new Point(10, 7),
                    new Point(8, 7),
                    new Point(9, 4)
                };
                using (SolidBrush symbolBrush = new SolidBrush(Color.White))
                {
                    g.FillPolygon(symbolBrush, bolt);
                }
            }
            return bmp;
        }

        public static Bitmap CreatePowerOutIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient circle background (Orange)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(2, 2, 12, 12),
                    Color.FromArgb(255, 160, 50),
                    Color.FromArgb(200, 80, 20),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 2, 2, 12, 12);
                }

                // Outer ring
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(1, 1, 14, 14),
                    Color.FromArgb(255, 180, 80),
                    Color.FromArgb(220, 100, 40),
                    LinearGradientMode.Vertical))
                {
                    using (Pen pen = new Pen(brush, 1.5f))
                    {
                        g.DrawEllipse(pen, 2, 2, 12, 12);
                    }
                }

                // White Antenna Symbol (Output)
                using (Pen pen = new Pen(Color.White, 1.5f))
                {
                    pen.StartCap = LineCap.Round;
                    pen.EndCap = LineCap.Round;
                    pen.LineJoin = LineJoin.Round;
                    
                    // Vertical stem
                    g.DrawLine(pen, 8, 12, 8, 7);
                    
                    // V-shape arms (Dipole)
                    g.DrawLine(pen, 8, 7, 4, 4);
                    g.DrawLine(pen, 8, 7, 12, 4);
                }
            }
            return bmp;
        }

        public static Bitmap CreateEfficiencyIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                // Percentage symbol with gradient
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(50, 180, 50),
                    Color.FromArgb(20, 130, 20),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(brush, 2, 2, 4, 4);
                    g.FillEllipse(brush, 10, 10, 4, 4);
                }
                using (Pen pen = new Pen(Color.FromArgb(30, 150, 30), 2.5f))
                {
                    pen.StartCap = LineCap.Round;
                    pen.EndCap = LineCap.Round;
                    g.DrawLine(pen, 3, 13, 13, 3);
                }
            }
            return bmp;
        }

        public static Bitmap CreateResistanceIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                // Resistor symbol (zigzag) with gradient
                Point[] points = new Point[]
                {
                    new Point(1, 8),
                    new Point(3, 4),
                    new Point(5, 12),
                    new Point(7, 4),
                    new Point(9, 12),
                    new Point(11, 4),
                    new Point(13, 12),
                    new Point(15, 8)
                };
                using (LinearGradientBrush brush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(180, 100, 50),
                    Color.FromArgb(120, 60, 20),
                    LinearGradientMode.Horizontal))
                {
                    using (Pen pen = new Pen(brush, 2.5f))
                    {
                        pen.StartCap = LineCap.Round;
                        pen.EndCap = LineCap.Round;
                        pen.LineJoin = LineJoin.Round;
                        g.DrawLines(pen, points);
                    }
                }
            }
            return bmp;
        }

        public static Bitmap CreateViewIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient background (Blue)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(60, 140, 220),
                    Color.FromArgb(30, 90, 180),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 1, 1, 14, 14);
                }

                // Eye symbol
                using (Pen pen = new Pen(Color.White, 1.5f))
                {
                    g.DrawArc(pen, 3, 5, 10, 6, 180, 180); // Top lid
                    g.DrawArc(pen, 3, 5, 10, 6, 0, 180);   // Bottom lid
                    
                    // Pupil
                    using (SolidBrush brush = new SolidBrush(Color.White))
                    {
                        g.FillEllipse(brush, 6.5f, 6.5f, 3, 3);
                    }
                }
            }
            return bmp;
        }

        public static Bitmap CreateResetWidthsIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient background (Teal)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(40, 180, 160),
                    Color.FromArgb(20, 120, 100),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 1, 1, 14, 14);
                }

                // Width symbol |<->|
                using (Pen pen = new Pen(Color.White, 1.5f))
                {
                    // Vertical lines
                    g.DrawLine(pen, 4, 4, 4, 12);
                    g.DrawLine(pen, 12, 4, 12, 12);
                    
                    // Arrow shaft
                    g.DrawLine(pen, 4, 8, 12, 8);
                    
                    // Arrow heads
                    // Left
                    g.DrawLine(pen, 4, 8, 6, 6);
                    g.DrawLine(pen, 4, 8, 6, 10);
                    // Right
                    g.DrawLine(pen, 12, 8, 10, 6);
                    g.DrawLine(pen, 12, 8, 10, 10);
                }
            }
            return bmp;
        }

        public static Bitmap CreateResetOrderIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient background (Purple/Indigo)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(120, 100, 220),
                    Color.FromArgb(80, 60, 160),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 1, 1, 14, 14);
                }

                // Swap arrows symbol
                using (Pen pen = new Pen(Color.White, 1.5f))
                {
                    // Top arrow (Right)
                    g.DrawLine(pen, 4, 6, 11, 6);
                    g.DrawLine(pen, 11, 6, 9, 4);
                    g.DrawLine(pen, 11, 6, 9, 8);

                    // Bottom arrow (Left)
                    g.DrawLine(pen, 12, 10, 5, 10);
                    g.DrawLine(pen, 5, 10, 7, 8);
                    g.DrawLine(pen, 5, 10, 7, 12);
                }
            }
            return bmp;
        }

        public static Bitmap CreateClearGridIcon()
        {
            Bitmap bmp = new Bitmap(16, 16);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                
                // Gradient background (Red)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(0, 0, 16, 16),
                    Color.FromArgb(220, 60, 60),
                    Color.FromArgb(160, 30, 30),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 1, 1, 14, 14);
                }

                // X symbol
                using (Pen pen = new Pen(Color.White, 2f))
                {
                    g.DrawLine(pen, 5, 5, 11, 11);
                    g.DrawLine(pen, 11, 5, 5, 11);
                }
            }
            return bmp;
        }

        public static Bitmap CreateAppIconImage()
        {
            int size = 64;
            Bitmap bmp = new Bitmap(size, size);
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.SmoothingMode = SmoothingMode.AntiAlias;
                g.TextRenderingHint = System.Drawing.Text.TextRenderingHint.AntiAlias;

                // Background shape (Dark Circle)
                using (LinearGradientBrush bgBrush = new LinearGradientBrush(
                    new Rectangle(0, 0, size, size),
                    Color.FromArgb(40, 40, 50),
                    Color.FromArgb(20, 20, 30),
                    LinearGradientMode.ForwardDiagonal))
                {
                    g.FillEllipse(bgBrush, 2, 2, size - 4, size - 4);
                }
                
                // Blue Ring
                using (Pen ringPen = new Pen(Color.FromArgb(0, 120, 215), 3))
                {
                    g.DrawEllipse(ringPen, 5, 5, size - 10, size - 10);
                }

                // Gauge Needle
                using (Pen needlePen = new Pen(Color.OrangeRed, 3))
                {
                    needlePen.EndCap = LineCap.Round;
                    // Center is 32,32
                    // Draw from center to top-right
                    g.DrawLine(needlePen, size / 2, size / 2 + 5, size * 0.7f, size * 0.3f);
                }
                
                // Center pivot
                using (SolidBrush pivotBrush = new SolidBrush(Color.White))
                {
                    g.FillEllipse(pivotBrush, size / 2 - 4, size / 2 - 4, 8, 8);
                }
                
                // Text "AM"
                using (Font font = new Font("Segoe UI", 14, FontStyle.Bold))
                using (SolidBrush textBrush = new SolidBrush(Color.White))
                {
                     StringFormat sf = new StringFormat();
                     sf.Alignment = StringAlignment.Center;
                     sf.LineAlignment = StringAlignment.Far;
                     g.DrawString("AM", font, textBrush, new Rectangle(0, 0, size, size - 12), sf);
                }
            }
            return bmp;
        }
    }
}
